---
title: "hw1_Mohapatra"
author: "Tanisha Mohapatra"
date: "2/18/2018"
output: html_document
---

```{r Section 1 Initial Setup}
knitr::opts_chunk$set(echo = TRUE)
library(tibble)
library(dplyr)
library(ggplot2)
download.file("https://raw.githubusercontent.com/GarciaRios/govt_6029/master/data/democracy.csv", destfile = "Lab1")
lab1data <- read.csv("Lab1", stringsAsFactors = FALSE, na.strings = ".")
```
###Initial Data Exploration

**Summary Statistics**

The summary statistics are generated by the code below. 
```{r Section 2.1 Initial Data Exploration}
summary(lab1data) #Summary Statistics for all variables
```
The mean and median for numeric variables are as follows:

- Country: This is just a classification system using assigned numeric values. The reported mean/median has no meaning.
- City Name: string variable
- Region: string variable
- Year of observation: Mean=1951; Median=1974
- Whether the country was a British Colony: Numbers are a classification system using dummies of 0 if not and 1 if true. Mean and Median have no meaning. 
- % of Catholics in the country: Mean=37.2%; Median=22.25%
- Degree of Civil Liberty on rising scale of 1-7: Mean=4.076; Median=5
- Average years of education: Mean=4.85 years; Median=4.54 years
- Ethnolinguistic Fractionalization: Mean= 0.3995; Median=0.37. Assuming the index calculates a percentage, this would translate to mean = 39.95% and median of 37%. 
- GDP per capita in real intl prices: Mean= 8877 dollars; Median= 6012 dollars
- % of Muslims in country: Mean = 19.74%; Median= 0.50% 
- If the country was created after 1945: Numbers are a classification system using dummies of 0 if not and 1 if true. Mean and Median have no meaning. 
- Whether oil accounts for 50%+ of exports: Numbers are a classification system using dummies of 0 if not and 1 if true. Mean and Median have no meaning. 
- Degree of Political Liberty on a rising scale of 1-7: Mean=3.86; Median=3
- Presence of democracy: Numbers are a classification system using dummies of 0 if not and 1 if true. Mean and Median have no meaning. 
- Count of recent regime transitions: Mean=0.375; Median=0

**Histograms**

The code below generates the following histograms:
1. Political Liberties (with each degree as its own bin)
2. GDP per capita
3. GDP per capita (Log Values)

```{r Section 2.2 Initial Data Exploration}
ggplot(lab1data, aes(x=POLLIB)) + 
  geom_histogram(binwidth = 1, color = "darkblue", fill = "lightblue") + 
  xlab("Scale of 1-7") + ylab("Count") + ggtitle("Political Liberty") + theme_bw() #Political Liberty histogram
ggplot(lab1data, aes(x=GDPW)) + 
  geom_histogram(color = "darkred", fill = "red") + 
  xlab("Level in Real Intl. Dollars") + ylab("Count") + ggtitle("GDP per Capita") + theme_bw() #GDPperCap histogram
ggplot(lab1data, aes(x=log(GDPW))) + 
  geom_histogram(binwidth = 0.1, color = "red", fill = "orange") + 
  xlab("Log GDP per Capita") + ylab("Count") + ggtitle("GDP Per Capita (Log Values)") + theme_bw() #LogGDPperCap histogram
```
Note the difference between the histograms for GDP per capita and that for GDP per Capita (Log Values). Whereas the histogram for GDP exhibits a heavy right skew, that is not the case with log GDP. With heavily skewed data (as was the case for GDP per capita), using a log transformation reduces the skew so that useful observations about the data can be made. 

###Explore Relationships 

**GDP and Poltical Liberty**

The code below creates a scatter plot to capture the relationship between GDP per capita and Political Liberty. As can be observed from the first graph, there is a lot of overlap between the plot points. Therefore, the second graph (with red points) randomly "jitters" the points up and down to mitigate the overplotting problem. 

Next, we observe changes to the graph pattern when we consider log values of GDP. Recall the difference observed in the previous section between the hisograms for just GDP (heavy right skew) and log GDP. Without jitters, there is a lot of overlap in the plot points. After using jitters, we can observe the difference between this graph and the second graph with red points that did not use log values for GDP per capita. Whereas the plot points were heavily concentrated in the left area of the graph in the non-log relationship, they are more evenly distributed in the log relationship, allowing us to make observations more easily. 

```{r Section 3.1 Explore Relationships}
ggplot(lab1data, aes(x = GDPW, y = POLLIB)) + 
  geom_point() +
  theme_bw() +
  labs(title = "Political Liberty & GDP", y = "Political Liberty Index", x = "Real GDP/capita (intl. USD)") #GDP per capita vs POLLIB
ggplot(lab1data, aes(x = GDPW, y = POLLIB)) + 
  geom_jitter(color = "darkred", fill = "red") +
  theme_bw() +
  labs(title = "Political Liberty & GDP (Jitter)", y = "Political Liberty Index", x = "Real GDP/capita (intl. USD)") #GDP per capita vs POLLIB -- jittered
ggplot(lab1data, aes(x = log(GDPW), y = POLLIB)) + 
  geom_point() +
  theme_bw() +
  labs(title = "Political Liberty & GDP (Log Values)", y = "Political Liberty Index", x = "Log Real GDP/capita (intl. USD)") #Log GDPW and POLLIB
ggplot(lab1data, aes(x = log(GDPW), y = POLLIB)) + 
  geom_jitter(color = "orange") +
  theme_bw() +
  labs(title = "Political Liberty & GDP Log Values (Jitter)", y = "Political Liberty Index", x = "Log Real GDP/capita (intl. USD)") #Log GDPW and POLLIB -- jittered
```

**GDP and Oil Production**
In this section, we will use box plots to observe the relationship between GDP per capita and whether oil comprises more than 50% of the country's exports. First, I am converting the variable OIL into a factor variable so that the data is recognized as discrete for the purpose of the boxplot. The code below generates a side by side boxplot showing the data patterns for per capita GDP levels in countries where oil less than 50% of exports, and in countries where oil is more than 50% of exports. 

```{r Section 3.2 Explore Relationships}
lab1data$OILfactor <- as.factor(lab1data$OIL) #discrete
ggplot(lab1data, aes(x = OILfactor, y = GDPW)) + 
  geom_boxplot() +
  theme_bw() +
  labs(title = "Oil Production & GDP", x = "Oil as a Percentage of Total Exports", y = "Real GDP/capita (intl. USD)")+
  scale_x_discrete(labels = c('< 50%','> 50%'))
```
From this boxplot, we can observe that the median per capita GDP level is higher for countries whose exports are comprised > 50% by oil. For these countries which have more than 50% of expors as oil, the 25th and 75th percentile is also higher, as is the interquartile range, however, we should note that for countries that have less than 50% of exports made up of oil, the total range for all values is bigger, but the upper bound is characterized with numerous outliers. Additionally, these countries (those in the < 50% bracket) have a per capita GDP distribution that is skewed right. In sum, we can conclude that big oil exporters will probably have a higher level of per capita GDP just by looking at this distribution. 

###Transform Data and Analyze

**Per Capita GDP & Religious Demographics**

- The mean GDP per capita for all countries is $9976.96.
- The mean GDP per capita for only countries with at least 40% catholics is $10295.13.

```{r Section 4.1 Transform Data and analyze}
mean(lab1data$GDPW)
cath40 <- filter(lab1data, CATH >= 40)
mean(cath40$GDPW)
```

**Ethnolinguistic Fractionalization**

The code below returns the average per capita GDP levels for varying levels of ethnolinguistic fractionalization. 

```{r Section 4.2 Transform Data and Analyze -- GDP vs elf60}
summary(lab1data$ELF60) #Note there are 542 NAs.
mean(filter(lab1data, ELF60 > 0.6)$GDPW) #avg gdp for elf60 > 60%
mean(filter(lab1data, ELF60 < 0.6)$GDPW) #avg gdp for elf60 < 60%
mean(filter(lab1data, ELF60 == 0)$GDPW) #avg gdp for elf60 = 0%
mean(filter(lab1data, is.na(ELF60))$GDPW) #avg gdp for elf60 as missing value (NA)
```
- Mean GDP for countries with > 60% ethnolinguistic fractionalization = $3590.95
- Mean GDP for countries with < 60% ethnolinguistic fractionalization = $11803.78
- Mean GDP for countries with zero ethnolinguistic fractionalization = $6307.946
- Mean GDP for countries that are missing any reported ethnolinguistic fractionalization (ELF60 = NA) = $7767.245

**Education Levels in 1985**

What was the median of the average years of education in 1985 for all countries?
5.625 years. Note that the code gives us the median with the 22 NAs, so this may not be the true median since the EDT vector in 1985 has missing values.

Which country was (or countries were) closest to the median years of education in 1985 among all countries?
Venezuela had the median of average years of education of 5.625 years. Closest after Venezuela were El Salvador (5.725 years) and Lesotho (5.52 years).

What was the median of the average years of education in 1985 for democracies?
7.805 years. Note that this gives us the median with the 6 NAs, so this may not be the true median since the vector has missing values.

Which democracy was (or democracies were) closest to the median years of education in 1985 among all democracies?
Mauritius had the median of average years of education of 7.805 years. Closest after Mauritius were Greece (7.485 years) and France (7.91 years). 

```{r Section 4.3 Transform Data and Analyze -- years of education}

summary(filter(lab1data, YEAR == 1985)$EDT) #Summary statisitics for 1985 education levels. Note that this gives us the median with the 22 NAs, so this may not be the true median since the vector has missing values.

lab1data %>% 
  filter(YEAR == 1985, EDT > 5.5 & EDT< 6) %>% 
  select(CTYNAME, EDT) %>% 
  arrange() #arranging countries within a small range close to the median we previously found.

summary(filter(lab1data, YEAR == 1985, REG == 1)$EDT) #Summary statistics for 1985 education levels in democracies only. Note that this gives us the median with the 6 NAs, so this may not be the true median since the vector has missing values.

lab1data %>% 
  filter(YEAR == 1985, REG == 1 , EDT > 7.4 & EDT< 8) %>% 
  select(CTYNAME, EDT) %>% 
  arrange() #arranging countries within a small range close to the median we previously found. 

```
**Ethnolinguistic Fractionalization in Old and New Countries**

The code below generates the summary statisitics for "old" and "new" countries. Old and New are classifications based on whether the country was created before 1945 (old) or whether the country was created after 1945 (new). This is captured by the variable NEWC which takes dummy values of 0 for old and 1 for new countries. 

```{r Section 4.4 Transform and Analyze -- ELF + Old and New}
#Old Countries
lab1data %>% 
  filter(NEWC == 0) %>% 
  select(ELF60) %>% 
  summary()

  
#New Countries
lab1data %>% 
  filter(NEWC == 1) %>% 
  select(ELF60) %>% 
  summary()

#side by side box plot
lab1data$NEWCfactor <- as.factor(lab1data$NEWC) #discrete
ggplot(lab1data, aes(x = NEWCfactor, y = ELF60*100)) + 
  geom_boxplot() +
  theme_bw() +
  labs(title = "Ethnolinguistic Fractionalization in Old and New Countries", x = "", y = "Ethnolinguistic Fractionalization in %")+
  scale_x_discrete(labels = c('Old Countries (pre 1945)','New Countries (post 1945)'))
```
For Old Countries, the 25th percentile is 0.06, translating to 6% fractionalization as the 25th percentile in Old Countries if the index caputures percentages reported as decimals. The 75th percentile is 0.44 translating to 44% fractionalization as the 75th percentile (assuming the index captures percentages reported as decimals). Note that there are 291 missing values here.

For New Countries, the 25th percentile is 0.42, translating to 42% fractionalization as the 25th percentile in Old Countries if the index caputures percentages reported as decimals. The 75th percentile is 0.75 translating to 75% fractionalization as the 75th percentile (assuming the index captures percentages reported as decimals). These levels are much higher than those for Old Countries. Note that there are 251 missing values here.

This big difference in the distribution of levels of ethnolinguistic fractionalization in old versus new countries is clear from the side by side box plot. 
